"use strict";const qt=require("@codemirror/state"),t=require("@lezer/highlight"),k=require("markedit-api"),J=require("@codemirror/view"),p=require("@codemirror/language"),j=(e,n={})=>e??n,Lt=j(k.MarkEdit.userSettings),Q=mt("extension.markeditTheming"),Pt=O(!1)?j(Q.lightTheme):void 0,Et=O(!0)?j(Q.darkTheme):void 0;function mt(e){return e===void 0?{}:j(Lt[e])}function ht(e){return e.enabledMode??"both"}function O(e,n=ht(Q)){return["both",e?"dark":"light"].includes(n)}function Gt(e,n,c){const r=Ot({lhs:c,rhs:e?Et:Pt});return{extensions:[...e?ct(r,{dark:!0}):ct(r),n].filter(o=>o!==void 0),colors:r}}function ct(e,n){const c={},r=[],a=e.editor,o=e.highlight;a?.textColor&&(c["&"]??={},c["&"].color=a?.textColor,c[".cm-activeLineGutter"]={backgroundColor:a?.textColor}),a?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=a?.backgroundColor),a?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:a?.activeLineBackground}),a?.caretColor&&(c[".cm-content"]={caretColor:a?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a?.caretColor}),a?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:a?.selectionBackground}),a?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:a?.matchingBracketBackground}),a?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=a?.gutterText),a?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=a?.gutterBackground,c[".cm-gutters"].border="none"),a?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=a?.foldPlaceholderText),a?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=a?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),a?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:a?.searchMatchBackground}),a?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:a?.selectionMatchBackground}),o?.heading&&r.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&r.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&r.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&r.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&r.push({tag:t.tags.quote,color:o?.quote}),o?.link&&r.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.divider&&r.push({tag:t.tags.contentSeparator,color:o?.divider}),o?.comment&&r.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&r.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&r.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&r.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&r.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&r.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&r.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&r.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&r.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&r.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&r.push({tag:t.tags.className,color:o?.class}),o?.macro&&r.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&r.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&r.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&r.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&r.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&r.push({tag:[t.tags.separator,t.tags.processingInstruction,t.tags.definition(t.tags.name)],color:o?.instruction}),o?.invalid&&r.push({tag:t.tags.invalid,color:o?.invalid});const i=[];return Object.keys(c).length>0&&i.push(J.EditorView.theme(c,n)),r.length>0&&i.push(p.syntaxHighlighting(p.HighlightStyle.define(r))),i}function Ot(e){return{editor:{...e.lhs?.editor,...e.rhs?.editor},highlight:{...e.lhs?.highlight,...e.rhs?.highlight},allowsFallback:e.rhs?.allowsFallback??e.lhs?.allowsFallback}}const l={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark, .cm-md-bold.tok-meta, .cm-md-italic.tok-meta, .cm-md-strikethrough.tok-meta",boldText:".cm-md-bold:not(.tok-meta)",italicText:".cm-md-italic:not(.tok-meta)",quoteText:".cm-md-quote:not(.cm-md-quoteMark)",dividerColor:".cm-md-horizontalRule"},jt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${l.lineGutter} {}
${l.foldGutter} {}
${l.visibleSpace} {}
${l.matchingBracket} {}
${l.activeIndicator} {}
${l.accentColor} {}
${l.syntaxMarker} {}
${l.boldText} {}
${l.italicText} {}
${l.quoteText} {}
${l.dividerColor} {}
`,ft=window,Ht=ft.__extractStyleRules__??(e=>e.value?.rules),Rt=ft.__extractHighlightSpecs__??(e=>e.value?.specs);function It(e){const n=document.createElement("style");return n.textContent=e,document.head.appendChild(n),n}function Vt(e){if(e.length===0)return[{},[]];const n=U(e);return[Object.fromEntries(n.flatMap(r=>{const a=Ht(r)?.join(`
`)??"";return Object.entries(Wt(a))})),n.flatMap(r=>Rt(r)??[])]}function h(e,n,c){return e.find(r=>!!(r.tag.toString().includes(n.toString())&&r.color!==void 0))?.color??c}function V(e,n,c){for(const[r,a]of Object.entries(e))if(r.includes(n)&&(c===void 0||!r.includes(c))){const o=a.background??a.backgroundColor;if(o!==void 0)return o}}function Dt(e){const n=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[c,r,a]=n.slice(1,4).map(Number);return`rgba(${c}, ${r}, ${a}, 0.6)`}function bt(e){const n=a=>a!==null&&typeof a=="object";if(!n(e))return!0;const c=Object.entries(e),r=a=>a!=null;for(const[,a]of c)if(n(a)){if(!bt(a))return!1}else if(r(a))return!1;return!0}function U(e){return Array.isArray(e)?e.flatMap(U):"extension"in e?U(e.extension):[e]}function Wt(e){const n={},c=new CSSStyleSheet;c.replaceSync(e);for(const r of c.cssRules){const{style:a,selectorText:o}=r,{background:i,backgroundColor:d}=a;n[o]={},i.length>0&&(n[o].background=i),d.length>0&&(n[o].backgroundColor=d)}return n}function Ft(e){const n=e.options?.settingsKey,c=ht(mt(n));e.light!==void 0&&O(!1,c)&&(s().customThemes.light=e.light),e.dark!==void 0&&O(!0,c)&&(s().customThemes.dark=e.dark),typeof k.MarkEdit.editorView=="object"&&z(k.MarkEdit.editorView)}const q=window,s=()=>q.__markeditTheming__,kt=matchMedia("(prefers-color-scheme: dark)");typeof s()!="object"&&Kt();function Kt(){q.__markeditTheming__={styleSheet:It(jt),configurator:new qt.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},k.MarkEdit.addExtension(s().configurator.of([])),k.MarkEdit.onEditorReady(n=>z(n));const e=()=>setTimeout(()=>z(k.MarkEdit.editorView),15);kt.addEventListener("change",e),s().mainThemeName=q.config.theme,Object.defineProperty(q.config,"theme",{get(){return s().mainThemeName},set(n){s().mainThemeName=n,e()}})}function z(e){const n=kt.matches,c=n?s().customThemes.dark:s().customThemes.light,{extensions:r,colors:a}=Gt(n,c?.extension,c?.colors);e.dispatch({effects:s().configurator.reconfigure(r)});const[o,i]=Vt(r),d=r.length===0&&bt(a),B=a.allowsFallback??c?.extension!==void 0;s().styleSheet.disabled=d,At(e,n,d,o,i,a,B)}function At(e,n,c,r,a,o,i){const d=V(r,".cm-activeLine",".cm-activeLineGutter"),B=V(r,l.selectionBackground),vt=V(r,l.matchingBracket),H=getComputedStyle(e.contentDOM).color,ot=o.editor?.visibleSpaceColor??Dt(H),m=i?H:void 0,et=h(a,t.tags.heading,m),xt=h(a,t.tags.processingInstruction,m),Bt=h(a,t.tags.strong,m),Tt=h(a,t.tags.emphasis,m),$t=h(a,t.tags.quote,m),St=h(a,t.tags.contentSeparator,m),Mt=[[l.activeIndicator,d,"background"],[l.matchingBracket,vt,"background"],[l.lineGutter,H,"color"],[l.foldGutter,ot,"color"],[l.visibleSpace,ot,"color"],[l.accentColor,et,"color"],[l.syntaxMarker,xt,"color"],[l.boldText,Bt,"color"],[l.italicText,Tt,"color"],[l.quoteText,$t,"color"],[l.dividerColor,St,"color"]],wt=Array.from(document.querySelectorAll("style")),T=n?s().darkOriginalRules:s().lightOriginalRules;for(const Nt of wt){const R=Nt.sheet?.cssRules;if(R!==void 0)for(let I=0;I<R.length;++I){const g=R[I],u=g.selectorText??"";u.includes(".cm-focused")&&u.includes(l.selectionBackground)&&(T.selectionBackground??=g.cssText,c?g.cssText=T.selectionBackground:B!==void 0&&g.style.setProperty("background",B,"important")),et!==void 0&&(u===".cm-md-header"||u===".cm-md-header:not(.cm-md-quote)")&&(T.markdownHeader??=g.cssText,c?g.cssText=T.markdownHeader:g.style.removeProperty("color"));for(const[_t,at,rt]of Mt)u===_t&&(at===void 0?g.style.removeProperty(rt):(g.style.setProperty(rt,at,"important"),(u===l.matchingBracket||u===l.activeIndicator)&&g.style.setProperty("box-shadow","unset","important")))}}}const Ut="#3c3836",zt="#504945",Jt="#665c54",Qt="#7c6f64",Xt="#928374",Yt="#fbf1c7",Zt="#ebdbb2",to="#bdae93",oo="#9d0006",eo="#79740e",ao="#b57614",ro="#076678",co="#8f3f71",no="#427b58",lo="#af3a03",pt=Yt,X=Zt,C=to,nt=Xt,f=Ut,so=zt,io=Jt,go=Qt,L=oo,$=eo,v=ao,D=ro,S=co,M=no,P=lo,lt=L,Y=X,W=Y,uo=pt,F=X,mo=Y,st=P,ho=J.EditorView.theme({"&":{color:f,backgroundColor:uo},".cm-content":{caretColor:st},".cm-cursor, .cm-dropCursor":{borderLeftColor:st},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:mo},".cm-panels":{backgroundColor:Y,color:f},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:pt,color:v,outline:`1px solid ${C}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:C},".cm-activeLine":{backgroundColor:W},".cm-selectionMatch":{backgroundColor:C},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${C}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:C},".cm-gutters":{backgroundColor:X,color:io,border:"none"},".cm-activeLineGutter":{backgroundColor:W},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:F},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:F,borderBottomColor:F},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:W,color:so}}},{dark:!1}),fo=p.HighlightStyle.define([{tag:t.tags.keyword,color:L},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:M},{tag:[t.tags.variableName],color:D},{tag:[t.tags.function(t.tags.variableName)],color:$,fontStyle:"bold"},{tag:[t.tags.labelName],color:f},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:S},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:f},{tag:[t.tags.brace],color:f},{tag:[t.tags.annotation],color:lt},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:S},{tag:[t.tags.typeName,t.tags.className],color:v},{tag:[t.tags.operator,t.tags.operatorKeyword],color:L},{tag:[t.tags.tagName],color:M,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:P},{tag:[t.tags.angleBracket],color:D},{tag:[t.tags.attributeName],color:M},{tag:[t.tags.regexp],color:M},{tag:[t.tags.quote],color:nt},{tag:[t.tags.string],color:f},{tag:t.tags.link,color:go,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:S},{tag:[t.tags.meta],color:v},{tag:[t.tags.comment],color:nt,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:P},{tag:t.tags.emphasis,fontStyle:"italic",color:$},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:$},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:$},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:v},{tag:[t.tags.heading5,t.tags.heading6],color:v},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:S},{tag:[t.tags.processingInstruction,t.tags.inserted],color:D},{tag:[t.tags.contentSeparator],color:L},{tag:t.tags.invalid,color:P,borderBottom:`1px dotted ${lt}`}]),bo=[ho,p.syntaxHighlighting(fo)],ko="#282828",po="#3c3836",Co="#665c54",yo="#928374",vo="#ebdbb2",xo="#d5c4a1",Bo="#bdae93",To="#a89984",$o="#fb4934",So="#b8bb26",Mo="#fabd2f",Ct="#83a598",wo="#d3869b",No="#8ec07c",_o="#fe8019",yt=ko,Z=po,y=Co,it=yo,b=vo,qo=xo,Lo=Bo,Po=To,E=$o,w=So,x=Mo,gt=Ct,N=wo,_=No,G=_o,dt=E,tt=Z,K=tt,Eo=yt,A=Z,Go=tt,ut=G,Oo=J.EditorView.theme({"&":{color:b,backgroundColor:Eo},".cm-content":{caretColor:ut},".cm-cursor, .cm-dropCursor":{borderLeftColor:ut},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Go},".cm-panels":{backgroundColor:tt,color:b},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:yt,color:x,outline:`1px solid ${y}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:y},".cm-activeLine":{backgroundColor:K},".cm-selectionMatch":{backgroundColor:y},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${y}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:y},".cm-gutters":{backgroundColor:Z,color:Lo,border:"none"},".cm-activeLineGutter":{backgroundColor:K},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:A},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:A,borderBottomColor:A},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:K,color:qo}}},{dark:!0}),jo=p.HighlightStyle.define([{tag:t.tags.keyword,color:E},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:_},{tag:[t.tags.variableName],color:gt},{tag:[t.tags.function(t.tags.variableName)],color:w,fontStyle:"bold"},{tag:[t.tags.labelName],color:b},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:N},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:b},{tag:[t.tags.brace],color:b},{tag:[t.tags.annotation],color:dt},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:N},{tag:[t.tags.typeName,t.tags.className],color:x},{tag:[t.tags.operator,t.tags.operatorKeyword],color:E},{tag:[t.tags.tagName],color:_,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:G},{tag:[t.tags.angleBracket],color:gt},{tag:[t.tags.attributeName],color:_},{tag:[t.tags.regexp],color:_},{tag:[t.tags.quote],color:it},{tag:[t.tags.string],color:b},{tag:t.tags.link,color:Po,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:N},{tag:[t.tags.meta],color:x},{tag:[t.tags.comment],color:it,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:G},{tag:t.tags.emphasis,fontStyle:"italic",color:w},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:w},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:w},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:x},{tag:[t.tags.heading5,t.tags.heading6],color:x},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:N},{tag:[t.tags.processingInstruction,t.tags.inserted],color:Ct},{tag:[t.tags.contentSeparator],color:E},{tag:t.tags.invalid,color:G,borderBottom:`1px dotted ${dt}`}]),Ho=[Oo,p.syntaxHighlighting(jo)];Ft({light:{extension:bo},dark:{extension:Ho},options:{settingsKey:"extension.markeditThemeGruvbox"}});
