"use strict";const St=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),D=require("@codemirror/view"),b=require("@codemirror/language"),P=(r,c={})=>r??c,Tt=P(m.MarkEdit.userSettings),A=P(Tt["extension.markeditTheming"]),Mt=A.enabledMode??"both",it=P(A.lightTheme),gt=P(A.darkTheme),dt=r=>["both",r?"dark":"light"].includes(Mt),Nt=mt(it),wt=mt(gt,{dark:!0});function _t(r,c){if(!dt(r))return c;const a=r?wt:Nt;return a===void 0?c:[a,c].filter(e=>e!==void 0)}function qt(r,c){if(!dt(r))return c;const a=r?gt.custom:it.custom;return a===void 0?c:{...c,...a}}function mt(r,c){const a={},e=[],n=r.editor,o=r.highlight;return n?.textColor&&(a["&"]??={},a["&"].color=n?.textColor,a[".cm-activeLineGutter"]={backgroundColor:n?.textColor}),n?.backgroundColor&&(a["&"]??={},a["&"].backgroundColor=n?.backgroundColor),n?.activeLineBackground&&(a[".cm-activeLine"]={backgroundColor:n?.activeLineBackground}),n?.caretColor&&(a[".cm-content"]={caretColor:n?.caretColor},a[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n?.caretColor}),n?.selectionBackground&&(a["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:n?.selectionBackground}),n?.matchingBracketBackground&&(a["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:n?.matchingBracketBackground}),n?.gutterText&&(a[".cm-gutters"]??={},a[".cm-gutters"].color=n?.gutterText),n?.gutterBackground&&(a[".cm-gutters"]??={},a[".cm-gutters"].backgroundColor=n?.gutterBackground,a[".cm-gutters"].border="none"),n?.foldPlaceholderText&&(a[".cm-foldPlaceholder"]??={},a[".cm-foldPlaceholder"].color=n?.foldPlaceholderText),n?.foldPlaceholderBackground&&(a[".cm-foldPlaceholder"]??={},a[".cm-foldPlaceholder"].backgroundColor=n?.foldPlaceholderBackground,a[".cm-foldPlaceholder"].border="none"),n?.searchMatchBackground&&(a[".cm-searchMatch"]={backgroundColor:n?.searchMatchBackground}),n?.selectionMatchBackground&&(a[".cm-selectionMatch"]={backgroundColor:n?.selectionMatchBackground}),o?.heading&&e.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&e.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&e.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&e.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&e.push({tag:t.tags.quote,color:o?.quote}),o?.link&&e.push({tag:t.tags.link,color:o?.link}),o?.separator&&e.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&e.push({tag:[t.tags.meta,t.tags.comment],color:o?.comment}),o?.meta&&e.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&e.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&e.push({tag:[t.tags.atom,t.tags.bool,t.tags.url,t.tags.contentSeparator,t.tags.labelName],color:o?.atom}),o?.literal&&e.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&e.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&e.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&e.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&e.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&e.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&e.push({tag:t.tags.className,color:o?.class}),o?.macro&&e.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&e.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&e.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&e.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&e.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&e.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&e.push({tag:t.tags.invalid,color:o?.invalid}),[D.EditorView.theme(a,c),b.syntaxHighlighting(b.HighlightStyle.define(e))]}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Lt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,ut=window,Pt=ut.__extractStyleRules__??(r=>r.value?.rules),Et=ut.__extractHighlightSpecs__??(r=>r.value?.specs);function Gt(r){const c=document.createElement("style");return c.textContent=r,document.head.appendChild(c),c}function Ht(r){if(r===void 0)return[{},[]];const c=Rt(r);return[Object.fromEntries(c.flatMap(e=>{const n=Pt(e)?.join(`
`)??"";return Object.entries(jt(n))})),c.flatMap(e=>Et(e)??[])]}function Z(r,c){return r.find(a=>!!(a.tag.toString().includes(c.toString())&&a.color!==void 0))?.color}function H(r,c,a){for(const[e,n]of Object.entries(r))if(e.includes(c)&&(a===void 0||!e.includes(a))){const o=n.background??n.backgroundColor;if(o!==void 0)return o}}function Ot(r){const c=r.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[a,e,n]=c.slice(1,4).map(Number);return`rgba(${a}, ${e}, ${n}, 0.6)`}function Rt(r){const c=[],a=[r];for(;a.length>0;){const e=a.pop();Array.isArray(e)?e.forEach(n=>a.push(n)):"extension"in e?a.push(e.extension):c.push(e)}return c}function jt(r){const c={},a=new CSSStyleSheet;a.replaceSync(r);for(const e of a.cssRules){const{style:n,selectorText:o}=e,{background:u,backgroundColor:g}=n;c[o]={},u.length>0&&(c[o].background=u),g.length>0&&(c[o].backgroundColor=g)}return c}function It(r){r.light!==void 0&&(l().customThemes.light=r.light),r.dark!==void 0&&(l().customThemes.dark=r.dark),typeof m.MarkEdit.editorView=="object"&&W(m.MarkEdit.editorView)}const N=window,l=()=>N.__markeditTheming__,ht=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&Vt();function Vt(){N.__markeditTheming__={styleSheet:Gt(Lt),configurator:new St.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(l().configurator.of([])),m.MarkEdit.onEditorReady(c=>W(c));const r=()=>setTimeout(()=>W(m.MarkEdit.editorView),15);ht.addEventListener("change",r),l().mainThemeName=N.config.theme,Object.defineProperty(N.config,"theme",{get(){return l().mainThemeName},set(c){l().mainThemeName=c,r()}})}function W(r){const c=ht.matches,a=c?l().customThemes.dark:l().customThemes.light,e=_t(c,a?.extension),n=qt(c,a?.colors);r.dispatch({effects:l().configurator.reconfigure(e??[])});const[o,u]=Ht(e),g=e===void 0;l().styleSheet.disabled=g,Wt(r,c,g,o,u,n)}function Wt(r,c,a,e,n,o){const u=H(e,".cm-activeLine",".cm-activeLineGutter"),g=H(e,s.selectionBackground),kt=H(e,s.matchingBracket),J=getComputedStyle(r.contentDOM).color,Q=o?.visibleSpace??Ot(J),yt=Z(n,t.tags.heading)!==void 0,Ct=Z(n,t.tags.processingInstruction),vt=[[s.activeIndicator,u,"background"],[s.matchingBracket,kt,"background"],[s.lineGutter,J,"color"],[s.foldGutter,Q,"color"],[s.visibleSpace,Q,"color"],[s.accentColor,o?.accentColor,"color"],[s.syntaxMarker,Ct??o?.syntaxMarker,"color"]],Bt=Array.from(document.querySelectorAll("style")),v=c?l().darkOriginalRules:l().lightOriginalRules;for(const xt of Bt){const E=xt.sheet?.cssRules;if(E!==void 0)for(let G=0;G<E.length;++G){const i=E[G],d=i.selectorText??"";d.includes(".cm-focused")&&d.includes(s.selectionBackground)&&(v.selectionBackground??=i.cssText,a?i.cssText=v.selectionBackground:g!==void 0&&i.style.setProperty("background",g,"important")),yt&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(v.markdownHeader??=i.cssText,a?i.cssText=v.markdownHeader:i.style.removeProperty("color"));for(const[$t,X,Y]of vt)d===$t&&(X===void 0?i.style.removeProperty(Y):(i.style.setProperty(Y,X,"important"),(d===s.matchingBracket||d===s.activeIndicator)&&i.style.setProperty("box-shadow","unset","important")));d===s.emphasisElement&&(o?.subtleEmphasis??!0?i.style.setProperty("color","inherit","important"):i.style.removeProperty("color"))}}}const Dt="#3c3836",At="#504945",Ut="#665c54",Kt="#7c6f64",zt="#928374",Ft="#fbf1c7",Jt="#ebdbb2",Qt="#bdae93",Xt="#9d0006",Yt="#79740e",Zt="#b57614",to="#076678",oo="#8f3f71",eo="#427b58",ao="#af3a03",ft=Ft,U=Jt,p=Qt,tt=zt,h=Dt,ro=At,co=Ut,no=Kt,w=Xt,B=Yt,y=Zt,O=to,x=oo,$=eo,_=ao,ot=w,K=U,R=K,so=ft,j=U,lo=K,et=_,io=D.EditorView.theme({"&":{color:h,backgroundColor:so},".cm-content":{caretColor:et},".cm-cursor, .cm-dropCursor":{borderLeftColor:et},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:lo},".cm-panels":{backgroundColor:K,color:h},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:ft,color:y,outline:`1px solid ${p}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:p},".cm-activeLine":{backgroundColor:R},".cm-selectionMatch":{backgroundColor:p},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${p}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:p},".cm-gutters":{backgroundColor:U,color:co,border:"none"},".cm-activeLineGutter":{backgroundColor:R},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:j},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:j,borderBottomColor:j},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:R,color:ro}}},{dark:!1}),go=b.HighlightStyle.define([{tag:t.tags.keyword,color:w},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:$},{tag:[t.tags.variableName],color:O},{tag:[t.tags.function(t.tags.variableName)],color:B,fontStyle:"bold"},{tag:[t.tags.labelName],color:h},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:x},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:h},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:ot},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:x},{tag:[t.tags.typeName,t.tags.className],color:y},{tag:[t.tags.operator,t.tags.operatorKeyword],color:w},{tag:[t.tags.tagName],color:$,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:_},{tag:[t.tags.angleBracket],color:O},{tag:[t.tags.attributeName],color:$},{tag:[t.tags.regexp],color:$},{tag:[t.tags.quote],color:tt},{tag:[t.tags.string],color:h},{tag:t.tags.link,color:no,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:x},{tag:[t.tags.meta],color:y},{tag:[t.tags.comment],color:tt,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:_},{tag:t.tags.emphasis,fontStyle:"italic",color:B},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:B},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:B},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:y},{tag:[t.tags.heading5,t.tags.heading6],color:y},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:x},{tag:[t.tags.processingInstruction,t.tags.inserted],color:O},{tag:[t.tags.contentSeparator],color:w},{tag:t.tags.invalid,color:_,borderBottom:`1px dotted ${ot}`}]),mo=[io,b.syntaxHighlighting(go)],uo="#282828",ho="#3c3836",fo="#665c54",bo="#928374",po="#ebdbb2",ko="#d5c4a1",yo="#bdae93",Co="#a89984",vo="#fb4934",Bo="#b8bb26",xo="#fabd2f",bt="#83a598",$o="#d3869b",So="#8ec07c",To="#fe8019",pt=uo,z=ho,k=fo,at=bo,f=po,Mo=ko,No=yo,wo=Co,q=vo,S=Bo,C=xo,rt=bt,T=$o,M=So,L=To,ct=q,F=z,I=F,_o=pt,V=z,qo=F,nt=L,Lo=D.EditorView.theme({"&":{color:f,backgroundColor:_o},".cm-content":{caretColor:nt},".cm-cursor, .cm-dropCursor":{borderLeftColor:nt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:qo},".cm-panels":{backgroundColor:F,color:f},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:pt,color:C,outline:`1px solid ${k}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:k},".cm-activeLine":{backgroundColor:I},".cm-selectionMatch":{backgroundColor:k},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${k}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:k},".cm-gutters":{backgroundColor:z,color:No,border:"none"},".cm-activeLineGutter":{backgroundColor:I},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:V},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:V,borderBottomColor:V},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:I,color:Mo}}},{dark:!0}),Po=b.HighlightStyle.define([{tag:t.tags.keyword,color:q},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:M},{tag:[t.tags.variableName],color:rt},{tag:[t.tags.function(t.tags.variableName)],color:S,fontStyle:"bold"},{tag:[t.tags.labelName],color:f},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:T},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:f},{tag:[t.tags.brace],color:f},{tag:[t.tags.annotation],color:ct},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:T},{tag:[t.tags.typeName,t.tags.className],color:C},{tag:[t.tags.operator,t.tags.operatorKeyword],color:q},{tag:[t.tags.tagName],color:M,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:L},{tag:[t.tags.angleBracket],color:rt},{tag:[t.tags.attributeName],color:M},{tag:[t.tags.regexp],color:M},{tag:[t.tags.quote],color:at},{tag:[t.tags.string],color:f},{tag:t.tags.link,color:wo,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:T},{tag:[t.tags.meta],color:C},{tag:[t.tags.comment],color:at,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:L},{tag:t.tags.emphasis,fontStyle:"italic",color:S},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:S},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:S},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:C},{tag:[t.tags.heading5,t.tags.heading6],color:C},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:T},{tag:[t.tags.processingInstruction,t.tags.inserted],color:bt},{tag:[t.tags.contentSeparator],color:q},{tag:t.tags.invalid,color:L,borderBottom:`1px dotted ${ct}`}]),Eo=[Lo,b.syntaxHighlighting(Po)],st=(r,c={})=>r??c,Go=st(st(m.MarkEdit.userSettings)["extension.markeditThemeGruvbox"]),lt=Go.enabledMode??"both",Ho={extension:mo},Oo={extension:Eo};It({light:["both","light"].includes(lt)?Ho:void 0,dark:["both","dark"].includes(lt)?Oo:void 0});
