"use strict";const Tt=require("@codemirror/state"),t=require("@lezer/highlight"),f=require("markedit-api"),A=require("@codemirror/view"),b=require("@codemirror/language"),P=(e,n={})=>e??n,Mt=P(f.MarkEdit.userSettings),U=dt("extension.markeditTheming"),Nt=L(!1)?P(U.lightTheme):void 0,wt=L(!0)?P(U.darkTheme):void 0;function dt(e){return e===void 0?{}:P(Mt[e])}function ut(e){return e.enabledMode??"both"}function L(e,n=ut(U)){return["both",e?"dark":"light"].includes(n)}function _t(e,n,c){const a=qt({lhs:c,rhs:e?wt:Nt});return{extensions:[...e?et(a,{dark:!0}):et(a),n].filter(o=>o!==void 0),colors:a}}function et(e,n){const c={},a=[],r=e.editor,o=e.highlight;r?.textColor&&(c["&"]??={},c["&"].color=r?.textColor,c[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(c[".cm-content"]={caretColor:r?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=r?.gutterBackground,c[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),o?.heading&&a.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&a.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&a.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&a.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&a.push({tag:t.tags.quote,color:o?.quote}),o?.link&&a.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&a.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&a.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&a.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&a.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&a.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&a.push({tag:t.tags.className,color:o?.class}),o?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&a.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&a.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&a.push({tag:t.tags.invalid,color:o?.invalid});const g=[];return Object.keys(c).length>0&&g.push(A.EditorView.theme(c,n)),a.length>0&&g.push(b.syntaxHighlighting(b.HighlightStyle.define(a))),g}function qt(e){return{editor:{...e.lhs?.editor,...e.rhs?.editor},highlight:{...e.lhs?.highlight,...e.rhs?.highlight},subtleEmphasis:e.rhs?.subtleEmphasis??e.lhs?.subtleEmphasis}}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Et=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,mt=window,Lt=mt.__extractStyleRules__??(e=>e.value?.rules),Pt=mt.__extractHighlightSpecs__??(e=>e.value?.specs);function Gt(e){const n=document.createElement("style");return n.textContent=e,document.head.appendChild(n),n}function Ot(e){if(e.length===0)return[{},[]];const n=W(e);return[Object.fromEntries(n.flatMap(a=>{const r=Lt(a)?.join(`
`)??"";return Object.entries(Ht(r))})),n.flatMap(a=>Pt(a)??[])]}function at(e,n){return e.find(c=>!!(c.tag.toString().includes(n.toString())&&c.color!==void 0))?.color}function j(e,n,c){for(const[a,r]of Object.entries(e))if(a.includes(n)&&(c===void 0||!a.includes(c))){const o=r.background??r.backgroundColor;if(o!==void 0)return o}}function jt(e){const n=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[c,a,r]=n.slice(1,4).map(Number);return`rgba(${c}, ${a}, ${r}, 0.6)`}function ht(e){const n=r=>r!==null&&typeof r=="object";if(!n(e))return!0;const c=Object.entries(e),a=r=>r!=null;for(const[,r]of c)if(n(r)){if(!ht(r))return!1}else if(a(r))return!1;return!0}function W(e){return Array.isArray(e)?e.flatMap(W):"extension"in e?W(e.extension):[e]}function Ht(e){const n={},c=new CSSStyleSheet;c.replaceSync(e);for(const a of c.cssRules){const{style:r,selectorText:o}=a,{background:g,backgroundColor:u}=r;n[o]={},g.length>0&&(n[o].background=g),u.length>0&&(n[o].backgroundColor=u)}return n}function Rt(e){const n=e.options?.settingsKey,c=ut(dt(n));e.light!==void 0&&L(!1,c)&&(l().customThemes.light=e.light),e.dark!==void 0&&L(!0,c)&&(l().customThemes.dark=e.dark),typeof f.MarkEdit.editorView=="object"&&K(f.MarkEdit.editorView)}const N=window,l=()=>N.__markeditTheming__,ft=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&It();function It(){N.__markeditTheming__={styleSheet:Gt(Et),configurator:new Tt.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},f.MarkEdit.addExtension(l().configurator.of([])),f.MarkEdit.onEditorReady(n=>K(n));const e=()=>setTimeout(()=>K(f.MarkEdit.editorView),15);ft.addEventListener("change",e),l().mainThemeName=N.config.theme,Object.defineProperty(N.config,"theme",{get(){return l().mainThemeName},set(n){l().mainThemeName=n,e()}})}function K(e){const n=ft.matches,c=n?l().customThemes.dark:l().customThemes.light,{extensions:a,colors:r}=_t(n,c?.extension,c?.colors);e.dispatch({effects:l().configurator.reconfigure(a)});const[o,g]=Ot(a),u=a.length===0&&ht(r);l().styleSheet.disabled=u,Vt(e,n,u,o,g,r)}function Vt(e,n,c,a,r,o){const g=j(a,".cm-activeLine",".cm-activeLineGutter"),u=j(a,s.selectionBackground),yt=j(a,s.matchingBracket),X=getComputedStyle(e.contentDOM).color,Y=o.editor?.visibleSpaceColor??jt(X),Z=at(r,t.tags.heading),Ct=at(r,t.tags.processingInstruction),vt=[[s.activeIndicator,g,"background"],[s.matchingBracket,yt,"background"],[s.lineGutter,X,"color"],[s.foldGutter,Y,"color"],[s.visibleSpace,Y,"color"],[s.accentColor,Z,"color"],[s.syntaxMarker,Ct,"color"]],xt=Array.from(document.querySelectorAll("style")),v=n?l().darkOriginalRules:l().lightOriginalRules;for(const Bt of xt){const G=Bt.sheet?.cssRules;if(G!==void 0)for(let O=0;O<G.length;++O){const i=G[O],d=i.selectorText??"";d.includes(".cm-focused")&&d.includes(s.selectionBackground)&&(v.selectionBackground??=i.cssText,c?i.cssText=v.selectionBackground:u!==void 0&&i.style.setProperty("background",u,"important")),Z!==void 0&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(v.markdownHeader??=i.cssText,c?i.cssText=v.markdownHeader:i.style.removeProperty("color"));for(const[$t,tt,ot]of vt)if(d===$t)if(tt===void 0)i.style.removeProperty(ot);else{const St=[s.accentColor,s.syntaxMarker].includes(d)?void 0:"important";i.style.setProperty(ot,tt,St),(d===s.matchingBracket||d===s.activeIndicator)&&i.style.setProperty("box-shadow","unset","important")}d===s.emphasisElement&&(o.subtleEmphasis??!0?i.style.setProperty("color","inherit","important"):i.style.removeProperty("color"))}}}const Dt="#3c3836",Wt="#504945",Kt="#665c54",At="#7c6f64",Ut="#928374",Ft="#fbf1c7",zt="#ebdbb2",Jt="#bdae93",Qt="#9d0006",Xt="#79740e",Yt="#b57614",Zt="#076678",to="#8f3f71",oo="#427b58",eo="#af3a03",bt=Ft,F=zt,p=Jt,rt=Ut,m=Dt,ao=Wt,ro=Kt,co=At,w=Qt,x=Xt,y=Yt,H=Zt,B=to,$=oo,_=eo,ct=w,z=F,R=z,no=bt,I=F,so=z,nt=_,lo=A.EditorView.theme({"&":{color:m,backgroundColor:no},".cm-content":{caretColor:nt},".cm-cursor, .cm-dropCursor":{borderLeftColor:nt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:so},".cm-panels":{backgroundColor:z,color:m},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:bt,color:y,outline:`1px solid ${p}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:p},".cm-activeLine":{backgroundColor:R},".cm-selectionMatch":{backgroundColor:p},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${p}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:p},".cm-gutters":{backgroundColor:F,color:ro,border:"none"},".cm-activeLineGutter":{backgroundColor:R},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:I},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:I,borderBottomColor:I},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:R,color:ao}}},{dark:!1}),io=b.HighlightStyle.define([{tag:t.tags.keyword,color:w},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:$},{tag:[t.tags.variableName],color:H},{tag:[t.tags.function(t.tags.variableName)],color:x,fontStyle:"bold"},{tag:[t.tags.labelName],color:m},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:B},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:m},{tag:[t.tags.brace],color:m},{tag:[t.tags.annotation],color:ct},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:B},{tag:[t.tags.typeName,t.tags.className],color:y},{tag:[t.tags.operator,t.tags.operatorKeyword],color:w},{tag:[t.tags.tagName],color:$,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:_},{tag:[t.tags.angleBracket],color:H},{tag:[t.tags.attributeName],color:$},{tag:[t.tags.regexp],color:$},{tag:[t.tags.quote],color:rt},{tag:[t.tags.string],color:m},{tag:t.tags.link,color:co,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:B},{tag:[t.tags.meta],color:y},{tag:[t.tags.comment],color:rt,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:_},{tag:t.tags.emphasis,fontStyle:"italic",color:x},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:x},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:x},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:y},{tag:[t.tags.heading5,t.tags.heading6],color:y},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:B},{tag:[t.tags.processingInstruction,t.tags.inserted],color:H},{tag:[t.tags.contentSeparator],color:w},{tag:t.tags.invalid,color:_,borderBottom:`1px dotted ${ct}`}]),go=[lo,b.syntaxHighlighting(io)],uo="#282828",mo="#3c3836",ho="#665c54",fo="#928374",bo="#ebdbb2",po="#d5c4a1",ko="#bdae93",yo="#a89984",Co="#fb4934",vo="#b8bb26",xo="#fabd2f",pt="#83a598",Bo="#d3869b",$o="#8ec07c",So="#fe8019",kt=uo,J=mo,k=ho,st=fo,h=bo,To=po,Mo=ko,No=yo,q=Co,S=vo,C=xo,lt=pt,T=Bo,M=$o,E=So,it=q,Q=J,V=Q,wo=kt,D=J,_o=Q,gt=E,qo=A.EditorView.theme({"&":{color:h,backgroundColor:wo},".cm-content":{caretColor:gt},".cm-cursor, .cm-dropCursor":{borderLeftColor:gt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:_o},".cm-panels":{backgroundColor:Q,color:h},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:kt,color:C,outline:`1px solid ${k}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:k},".cm-activeLine":{backgroundColor:V},".cm-selectionMatch":{backgroundColor:k},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${k}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:k},".cm-gutters":{backgroundColor:J,color:Mo,border:"none"},".cm-activeLineGutter":{backgroundColor:V},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:D},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:D,borderBottomColor:D},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:V,color:To}}},{dark:!0}),Eo=b.HighlightStyle.define([{tag:t.tags.keyword,color:q},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:M},{tag:[t.tags.variableName],color:lt},{tag:[t.tags.function(t.tags.variableName)],color:S,fontStyle:"bold"},{tag:[t.tags.labelName],color:h},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:T},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:h},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:it},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:T},{tag:[t.tags.typeName,t.tags.className],color:C},{tag:[t.tags.operator,t.tags.operatorKeyword],color:q},{tag:[t.tags.tagName],color:M,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:E},{tag:[t.tags.angleBracket],color:lt},{tag:[t.tags.attributeName],color:M},{tag:[t.tags.regexp],color:M},{tag:[t.tags.quote],color:st},{tag:[t.tags.string],color:h},{tag:t.tags.link,color:No,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:T},{tag:[t.tags.meta],color:C},{tag:[t.tags.comment],color:st,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:E},{tag:t.tags.emphasis,fontStyle:"italic",color:S},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:S},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:S},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:C},{tag:[t.tags.heading5,t.tags.heading6],color:C},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:T},{tag:[t.tags.processingInstruction,t.tags.inserted],color:pt},{tag:[t.tags.contentSeparator],color:q},{tag:t.tags.invalid,color:E,borderBottom:`1px dotted ${it}`}]),Lo=[qo,b.syntaxHighlighting(Eo)];Rt({light:{extension:go},dark:{extension:Lo},options:{settingsKey:"extension.markeditThemeGruvbox"}});
