"use strict";const St=require("@codemirror/state"),t=require("@lezer/highlight"),u=require("markedit-api"),A=require("@codemirror/view"),b=require("@codemirror/language"),L=(e,n={})=>e??n,Tt=L(u.MarkEdit.userSettings),U=L(Tt["extension.markeditTheming"]),Mt=U.enabledMode??"both",Nt=L(U.lightTheme),wt=L(U.darkTheme),_t=e=>["both",e?"dark":"light"].includes(Mt);function qt(e,n,c){const a=Et({lhs:c,rhs:_t(e)?e?wt:Nt:void 0});return{extensions:[...e?ot(a,{dark:!0}):ot(a),n].filter(o=>o!==void 0),colors:a}}function ot(e,n){const c={},a=[],r=e.editor,o=e.highlight;r?.textColor&&(c["&"]??={},c["&"].color=r?.textColor,c[".cm-activeLineGutter"]={backgroundColor:r?.textColor}),r?.backgroundColor&&(c["&"]??={},c["&"].backgroundColor=r?.backgroundColor),r?.activeLineBackground&&(c[".cm-activeLine"]={backgroundColor:r?.activeLineBackground}),r?.caretColor&&(c[".cm-content"]={caretColor:r?.caretColor},c[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r?.caretColor}),r?.selectionBackground&&(c["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:r?.selectionBackground}),r?.matchingBracketBackground&&(c["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:r?.matchingBracketBackground}),r?.gutterText&&(c[".cm-gutters"]??={},c[".cm-gutters"].color=r?.gutterText),r?.gutterBackground&&(c[".cm-gutters"]??={},c[".cm-gutters"].backgroundColor=r?.gutterBackground,c[".cm-gutters"].border="none"),r?.foldPlaceholderText&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].color=r?.foldPlaceholderText),r?.foldPlaceholderBackground&&(c[".cm-foldPlaceholder"]??={},c[".cm-foldPlaceholder"].backgroundColor=r?.foldPlaceholderBackground,c[".cm-foldPlaceholder"].border="none"),r?.searchMatchBackground&&(c[".cm-searchMatch"]={backgroundColor:r?.searchMatchBackground}),r?.selectionMatchBackground&&(c[".cm-selectionMatch"]={backgroundColor:r?.selectionMatchBackground}),o?.heading&&a.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&a.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&a.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&a.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&a.push({tag:t.tags.quote,color:o?.quote}),o?.link&&a.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&a.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&a.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&a.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&a.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&a.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&a.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&a.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&a.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&a.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&a.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&a.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&a.push({tag:t.tags.className,color:o?.class}),o?.macro&&a.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&a.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&a.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&a.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&a.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&a.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&a.push({tag:t.tags.invalid,color:o?.invalid});const g=[];return Object.keys(c).length>0&&g.push(A.EditorView.theme(c,n)),a.length>0&&g.push(b.syntaxHighlighting(b.HighlightStyle.define(a))),g}function Et(e){return{editor:{...e.lhs?.editor,...e.rhs?.editor},highlight:{...e.lhs?.highlight,...e.rhs?.highlight},subtleEmphasis:e.rhs?.subtleEmphasis??e.lhs?.subtleEmphasis}}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Lt=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,mt=window,Pt=mt.__extractStyleRules__??(e=>e.value?.rules),Gt=mt.__extractHighlightSpecs__??(e=>e.value?.specs);function Ot(e){const n=document.createElement("style");return n.textContent=e,document.head.appendChild(n),n}function jt(e){if(e.length===0)return[{},[]];const n=W(e);return[Object.fromEntries(n.flatMap(a=>{const r=Pt(a)?.join(`
`)??"";return Object.entries(Rt(r))})),n.flatMap(a=>Gt(a)??[])]}function et(e,n){return e.find(c=>!!(c.tag.toString().includes(n.toString())&&c.color!==void 0))?.color}function O(e,n,c){for(const[a,r]of Object.entries(e))if(a.includes(n)&&(c===void 0||!a.includes(c))){const o=r.background??r.backgroundColor;if(o!==void 0)return o}}function Ht(e){const n=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(n===null)return;const[c,a,r]=n.slice(1,4).map(Number);return`rgba(${c}, ${a}, ${r}, 0.6)`}function ut(e){const n=r=>r!==null&&typeof r=="object";if(!n(e))return!0;const c=Object.entries(e),a=r=>r!=null;for(const[,r]of c)if(n(r)){if(!ut(r))return!1}else if(a(r))return!1;return!0}function W(e){return Array.isArray(e)?e.flatMap(W):"extension"in e?W(e.extension):[e]}function Rt(e){const n={},c=new CSSStyleSheet;c.replaceSync(e);for(const a of c.cssRules){const{style:r,selectorText:o}=a,{background:g,backgroundColor:m}=r;n[o]={},g.length>0&&(n[o].background=g),m.length>0&&(n[o].backgroundColor=m)}return n}function It(e){e.light!==void 0&&(l().customThemes.light=e.light),e.dark!==void 0&&(l().customThemes.dark=e.dark),typeof u.MarkEdit.editorView=="object"&&D(u.MarkEdit.editorView)}const N=window,l=()=>N.__markeditTheming__,ht=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&Vt();function Vt(){N.__markeditTheming__={styleSheet:Ot(Lt),configurator:new St.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},u.MarkEdit.addExtension(l().configurator.of([])),u.MarkEdit.onEditorReady(n=>D(n));const e=()=>setTimeout(()=>D(u.MarkEdit.editorView),15);ht.addEventListener("change",e),l().mainThemeName=N.config.theme,Object.defineProperty(N.config,"theme",{get(){return l().mainThemeName},set(n){l().mainThemeName=n,e()}})}function D(e){const n=ht.matches,c=n?l().customThemes.dark:l().customThemes.light,{extensions:a,colors:r}=qt(n,c?.extension,c?.colors);e.dispatch({effects:l().configurator.reconfigure(a)});const[o,g]=jt(a),m=a.length===0&&ut(r);l().styleSheet.disabled=m,Wt(e,n,m,o,g,r)}function Wt(e,n,c,a,r,o){const g=O(a,".cm-activeLine",".cm-activeLineGutter"),m=O(a,s.selectionBackground),kt=O(a,s.matchingBracket),Q=getComputedStyle(e.contentDOM).color,X=o.editor?.visibleSpaceColor??Ht(Q),Y=et(r,t.tags.heading),yt=et(r,t.tags.processingInstruction),Ct=[[s.activeIndicator,g,"background"],[s.matchingBracket,kt,"background"],[s.lineGutter,Q,"color"],[s.foldGutter,X,"color"],[s.visibleSpace,X,"color"],[s.accentColor,Y,"color"],[s.syntaxMarker,yt,"color"]],vt=Array.from(document.querySelectorAll("style")),v=n?l().darkOriginalRules:l().lightOriginalRules;for(const xt of vt){const P=xt.sheet?.cssRules;if(P!==void 0)for(let G=0;G<P.length;++G){const i=P[G],d=i.selectorText??"";d.includes(".cm-focused")&&d.includes(s.selectionBackground)&&(v.selectionBackground??=i.cssText,c?i.cssText=v.selectionBackground:m!==void 0&&i.style.setProperty("background",m,"important")),Y!==void 0&&(d===".cm-md-header"||d===".cm-md-header:not(.cm-md-quote)")&&(v.markdownHeader??=i.cssText,c?i.cssText=v.markdownHeader:i.style.removeProperty("color"));for(const[Bt,Z,tt]of Ct)if(d===Bt)if(Z===void 0)i.style.removeProperty(tt);else{const $t=[s.accentColor,s.syntaxMarker].includes(d)?void 0:"important";i.style.setProperty(tt,Z,$t),(d===s.matchingBracket||d===s.activeIndicator)&&i.style.setProperty("box-shadow","unset","important")}d===s.emphasisElement&&(o.subtleEmphasis??!0?i.style.setProperty("color","inherit","important"):i.style.removeProperty("color"))}}}const Dt="#3c3836",At="#504945",Ut="#665c54",Kt="#7c6f64",zt="#928374",Ft="#fbf1c7",Jt="#ebdbb2",Qt="#bdae93",Xt="#9d0006",Yt="#79740e",Zt="#b57614",to="#076678",oo="#8f3f71",eo="#427b58",ao="#af3a03",ft=Ft,K=Jt,p=Qt,at=zt,h=Dt,ro=At,co=Ut,no=Kt,w=Xt,x=Yt,y=Zt,j=to,B=oo,$=eo,_=ao,rt=w,z=K,H=z,so=ft,R=K,lo=z,ct=_,io=A.EditorView.theme({"&":{color:h,backgroundColor:so},".cm-content":{caretColor:ct},".cm-cursor, .cm-dropCursor":{borderLeftColor:ct},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:lo},".cm-panels":{backgroundColor:z,color:h},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:ft,color:y,outline:`1px solid ${p}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:p},".cm-activeLine":{backgroundColor:H},".cm-selectionMatch":{backgroundColor:p},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${p}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:p},".cm-gutters":{backgroundColor:K,color:co,border:"none"},".cm-activeLineGutter":{backgroundColor:H},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:R},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:R,borderBottomColor:R},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:H,color:ro}}},{dark:!1}),go=b.HighlightStyle.define([{tag:t.tags.keyword,color:w},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:$},{tag:[t.tags.variableName],color:j},{tag:[t.tags.function(t.tags.variableName)],color:x,fontStyle:"bold"},{tag:[t.tags.labelName],color:h},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:B},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:h},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:rt},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:B},{tag:[t.tags.typeName,t.tags.className],color:y},{tag:[t.tags.operator,t.tags.operatorKeyword],color:w},{tag:[t.tags.tagName],color:$,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:_},{tag:[t.tags.angleBracket],color:j},{tag:[t.tags.attributeName],color:$},{tag:[t.tags.regexp],color:$},{tag:[t.tags.quote],color:at},{tag:[t.tags.string],color:h},{tag:t.tags.link,color:no,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:B},{tag:[t.tags.meta],color:y},{tag:[t.tags.comment],color:at,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:_},{tag:t.tags.emphasis,fontStyle:"italic",color:x},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:x},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:x},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:y},{tag:[t.tags.heading5,t.tags.heading6],color:y},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:B},{tag:[t.tags.processingInstruction,t.tags.inserted],color:j},{tag:[t.tags.contentSeparator],color:w},{tag:t.tags.invalid,color:_,borderBottom:`1px dotted ${rt}`}]),mo=[io,b.syntaxHighlighting(go)],uo="#282828",ho="#3c3836",fo="#665c54",bo="#928374",po="#ebdbb2",ko="#d5c4a1",yo="#bdae93",Co="#a89984",vo="#fb4934",xo="#b8bb26",Bo="#fabd2f",bt="#83a598",$o="#d3869b",So="#8ec07c",To="#fe8019",pt=uo,F=ho,k=fo,nt=bo,f=po,Mo=ko,No=yo,wo=Co,q=vo,S=xo,C=Bo,st=bt,T=$o,M=So,E=To,lt=q,J=F,I=J,_o=pt,V=F,qo=J,it=E,Eo=A.EditorView.theme({"&":{color:f,backgroundColor:_o},".cm-content":{caretColor:it},".cm-cursor, .cm-dropCursor":{borderLeftColor:it},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:qo},".cm-panels":{backgroundColor:J,color:f},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:pt,color:C,outline:`1px solid ${k}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:k},".cm-activeLine":{backgroundColor:I},".cm-selectionMatch":{backgroundColor:k},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${k}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:k},".cm-gutters":{backgroundColor:F,color:No,border:"none"},".cm-activeLineGutter":{backgroundColor:I},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:V},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:V,borderBottomColor:V},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:I,color:Mo}}},{dark:!0}),Lo=b.HighlightStyle.define([{tag:t.tags.keyword,color:q},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:M},{tag:[t.tags.variableName],color:st},{tag:[t.tags.function(t.tags.variableName)],color:S,fontStyle:"bold"},{tag:[t.tags.labelName],color:f},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:T},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:f},{tag:[t.tags.brace],color:f},{tag:[t.tags.annotation],color:lt},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:T},{tag:[t.tags.typeName,t.tags.className],color:C},{tag:[t.tags.operator,t.tags.operatorKeyword],color:q},{tag:[t.tags.tagName],color:M,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:E},{tag:[t.tags.angleBracket],color:st},{tag:[t.tags.attributeName],color:M},{tag:[t.tags.regexp],color:M},{tag:[t.tags.quote],color:nt},{tag:[t.tags.string],color:f},{tag:t.tags.link,color:wo,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:T},{tag:[t.tags.meta],color:C},{tag:[t.tags.comment],color:nt,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:E},{tag:t.tags.emphasis,fontStyle:"italic",color:S},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:S},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:S},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:C},{tag:[t.tags.heading5,t.tags.heading6],color:C},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:T},{tag:[t.tags.processingInstruction,t.tags.inserted],color:bt},{tag:[t.tags.contentSeparator],color:q},{tag:t.tags.invalid,color:E,borderBottom:`1px dotted ${lt}`}]),Po=[Eo,b.syntaxHighlighting(Lo)],gt=(e,n={})=>e??n,Go=gt(gt(u.MarkEdit.userSettings)["extension.markeditThemeGruvbox"]),dt=Go.enabledMode??"both",Oo={extension:mo},jo={extension:Po};It({light:["both","light"].includes(dt)?Oo:void 0,dark:["both","dark"].includes(dt)?jo:void 0});
