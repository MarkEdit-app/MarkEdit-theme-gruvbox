"use strict";const Mt=require("@codemirror/state"),t=require("@lezer/highlight"),m=require("markedit-api"),A=require("@codemirror/view"),b=require("@codemirror/language"),P=(e,c={})=>e??c,Nt=P(m.MarkEdit.userSettings),U=P(Nt["extension.markeditTheming"]),wt=U.enabledMode??"both",dt=P(U.lightTheme),mt=P(U.darkTheme),ut=e=>["both",e?"dark":"light"].includes(wt),_t=ht(dt),qt=ht(mt,{dark:!0});function Lt(e,c){if(!ut(e))return c;const a=e?qt:_t;return a===void 0?c:[a,c].filter(r=>r!==void 0)}function Pt(e,c){if(!ut(e))return c;const a=e?mt.custom:dt.custom;return a===void 0?c:{...c,...a}}function ht(e,c){const a={},r=[],n=e.editor,o=e.highlight;return n?.textColor&&(a["&"]??={},a["&"].color=n?.textColor,a[".cm-activeLineGutter"]={backgroundColor:n?.textColor}),n?.backgroundColor&&(a["&"]??={},a["&"].backgroundColor=n?.backgroundColor),n?.activeLineBackground&&(a[".cm-activeLine"]={backgroundColor:n?.activeLineBackground}),n?.caretColor&&(a[".cm-content"]={caretColor:n?.caretColor},a[".cm-cursor, .cm-dropCursor"]={borderLeftColor:n?.caretColor}),n?.selectionBackground&&(a["&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection"]={backgroundColor:n?.selectionBackground}),n?.matchingBracketBackground&&(a["&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket"]={backgroundColor:n?.matchingBracketBackground}),n?.gutterText&&(a[".cm-gutters"]??={},a[".cm-gutters"].color=n?.gutterText),n?.gutterBackground&&(a[".cm-gutters"]??={},a[".cm-gutters"].backgroundColor=n?.gutterBackground,a[".cm-gutters"].border="none"),n?.foldPlaceholderText&&(a[".cm-foldPlaceholder"]??={},a[".cm-foldPlaceholder"].color=n?.foldPlaceholderText),n?.foldPlaceholderBackground&&(a[".cm-foldPlaceholder"]??={},a[".cm-foldPlaceholder"].backgroundColor=n?.foldPlaceholderBackground,a[".cm-foldPlaceholder"].border="none"),n?.searchMatchBackground&&(a[".cm-searchMatch"]={backgroundColor:n?.searchMatchBackground}),n?.selectionMatchBackground&&(a[".cm-selectionMatch"]={backgroundColor:n?.selectionMatchBackground}),o?.heading&&r.push({tag:t.tags.heading,color:o?.heading}),o?.bold&&r.push({tag:t.tags.strong,color:o?.bold}),o?.italic&&r.push({tag:t.tags.emphasis,color:o?.italic}),o?.strikethrough&&r.push({tag:t.tags.strikethrough,color:o?.strikethrough}),o?.quote&&r.push({tag:t.tags.quote,color:o?.quote}),o?.link&&r.push({tag:[t.tags.url,t.tags.link],color:o?.link}),o?.separator&&r.push({tag:[t.tags.definition(t.tags.name),t.tags.separator,t.tags.contentSeparator],color:o?.separator}),o?.comment&&r.push({tag:t.tags.comment,color:o?.comment}),o?.meta&&r.push({tag:t.tags.meta,color:o?.meta}),o?.keyword&&r.push({tag:t.tags.keyword,color:o?.keyword}),o?.atom&&r.push({tag:[t.tags.atom,t.tags.bool],color:o?.atom}),o?.literal&&r.push({tag:[t.tags.literal,t.tags.inserted],color:o?.literal}),o?.string&&r.push({tag:[t.tags.string,t.tags.deleted],color:o?.string}),o?.special&&r.push({tag:[t.tags.regexp,t.tags.escape,t.tags.special(t.tags.string)],color:o?.special}),o?.variable&&r.push({tag:t.tags.definition(t.tags.variableName),color:o?.variable}),o?.local&&r.push({tag:t.tags.local(t.tags.variableName),color:o?.local}),o?.type&&r.push({tag:[t.tags.typeName,t.tags.namespace],color:o?.type}),o?.class&&r.push({tag:t.tags.className,color:o?.class}),o?.macro&&r.push({tag:[t.tags.special(t.tags.variableName),t.tags.macroName],color:o?.macro}),o?.property&&r.push({tag:t.tags.definition(t.tags.propertyName),color:o?.property}),o?.label&&r.push({tag:t.tags.labelName,color:o?.label}),o?.operator&&r.push({tag:[t.tags.operator,t.tags.operatorKeyword],color:o?.operator}),o?.constant&&r.push({tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:o?.constant}),o?.instruction&&r.push({tag:t.tags.processingInstruction,color:o?.instruction}),o?.invalid&&r.push({tag:t.tags.invalid,color:o?.invalid}),[A.EditorView.theme(a,c),b.syntaxHighlighting(b.HighlightStyle.define(r))]}const s={selectionBackground:".cm-selectionBackground",lineGutter:".cm-lineNumbers > .cm-activeLineGutter",foldGutter:".cm-foldGutter, .cm-foldPlaceholder",visibleSpace:".cm-visibleSpace, .cm-visibleSpace::before, .cm-visibleLineBreak, .cm-visibleLineBreak::before",matchingBracket:".cm-matchingBracket",activeIndicator:".cm-md-activeIndicator",emphasisElement:".cm-md-bold:not(.tok-meta), .cm-md-italic:not(.tok-meta), .cm-md-quote:not(.cm-md-quoteMark)",accentColor:".cm-md-header:not(.tok-meta):not(.cm-md-quote), .cm-md-codeInfo",syntaxMarker:".cm-md-header.tok-meta:not(.cm-md-quote), .cm-md-codeMark, .cm-md-linkMark, .cm-md-listMark, .cm-md-quoteMark"},Et=`
.cm-activeLineGutter { background: inherit !important }
.cm-searchMatch.cm-searchMatch-selected { outline: inherit !important }
${s.lineGutter} {}
${s.foldGutter} {}
${s.visibleSpace} {}
${s.matchingBracket} {}
${s.activeIndicator} {}
${s.emphasisElement} {}
${s.accentColor} {}
${s.syntaxMarker} {}
`,ft=window,Gt=ft.__extractStyleRules__??(e=>e.value?.rules),Ht=ft.__extractHighlightSpecs__??(e=>e.value?.specs);function Ot(e){const c=document.createElement("style");return c.textContent=e,document.head.appendChild(c),c}function Rt(e){if(e===void 0)return[{},[]];const c=W(e);return[Object.fromEntries(c.flatMap(r=>{const n=Gt(r)?.join(`
`)??"";return Object.entries(It(n))})),c.flatMap(r=>Ht(r)??[])]}function ot(e,c){return e.find(a=>!!(a.tag.toString().includes(c.toString())&&a.color!==void 0))?.color}function H(e,c,a){for(const[r,n]of Object.entries(e))if(r.includes(c)&&(a===void 0||!r.includes(a))){const o=n.background??n.backgroundColor;if(o!==void 0)return o}}function jt(e){const c=e.match(/rgba?\((\d+), (\d+), (\d+)(?:, ([\d.]+))?\)/);if(c===null)return;const[a,r,n]=c.slice(1,4).map(Number);return`rgba(${a}, ${r}, ${n}, 0.6)`}function W(e){return Array.isArray(e)?e.flatMap(W):"extension"in e?W(e.extension):[e]}function It(e){const c={},a=new CSSStyleSheet;a.replaceSync(e);for(const r of a.cssRules){const{style:n,selectorText:o}=r,{background:u,backgroundColor:d}=n;c[o]={},u.length>0&&(c[o].background=u),d.length>0&&(c[o].backgroundColor=d)}return c}function Vt(e){e.light!==void 0&&(l().customThemes.light=e.light),e.dark!==void 0&&(l().customThemes.dark=e.dark),typeof m.MarkEdit.editorView=="object"&&D(m.MarkEdit.editorView)}const N=window,l=()=>N.__markeditTheming__,bt=matchMedia("(prefers-color-scheme: dark)");typeof l()!="object"&&Wt();function Wt(){N.__markeditTheming__={styleSheet:Ot(Et),configurator:new Mt.Compartment,customThemes:{},lightOriginalRules:{},darkOriginalRules:{}},m.MarkEdit.addExtension(l().configurator.of([])),m.MarkEdit.onEditorReady(c=>D(c));const e=()=>setTimeout(()=>D(m.MarkEdit.editorView),15);bt.addEventListener("change",e),l().mainThemeName=N.config.theme,Object.defineProperty(N.config,"theme",{get(){return l().mainThemeName},set(c){l().mainThemeName=c,e()}})}function D(e){const c=bt.matches,a=c?l().customThemes.dark:l().customThemes.light,r=Lt(c,a?.extension),n=Pt(c,a?.colors);e.dispatch({effects:l().configurator.reconfigure(r??[])});const[o,u]=Rt(r),d=r===void 0;l().styleSheet.disabled=d,Dt(e,c,d,o,u,n)}function Dt(e,c,a,r,n,o){const u=H(r,".cm-activeLine",".cm-activeLineGutter"),d=H(r,s.selectionBackground),Ct=H(r,s.matchingBracket),Q=getComputedStyle(e.contentDOM).color,X=o?.visibleSpace??jt(Q),Y=ot(n,t.tags.heading),vt=ot(n,t.tags.processingInstruction),xt=[[s.activeIndicator,u,"background"],[s.matchingBracket,Ct,"background"],[s.lineGutter,Q,"color"],[s.foldGutter,X,"color"],[s.visibleSpace,X,"color"],[s.accentColor,o?.accentColor??Y,"color"],[s.syntaxMarker,o?.syntaxMarker??vt,"color"]],Bt=Array.from(document.querySelectorAll("style")),v=c?l().darkOriginalRules:l().lightOriginalRules;for(const $t of Bt){const E=$t.sheet?.cssRules;if(E!==void 0)for(let G=0;G<E.length;++G){const i=E[G],g=i.selectorText??"";g.includes(".cm-focused")&&g.includes(s.selectionBackground)&&(v.selectionBackground??=i.cssText,a?i.cssText=v.selectionBackground:d!==void 0&&i.style.setProperty("background",d,"important")),Y!==void 0&&(g===".cm-md-header"||g===".cm-md-header:not(.cm-md-quote)")&&(v.markdownHeader??=i.cssText,a?i.cssText=v.markdownHeader:i.style.removeProperty("color"));for(const[Tt,Z,tt]of xt)if(g===Tt)if(Z===void 0)i.style.removeProperty(tt);else{const St=[s.accentColor,s.syntaxMarker].includes(g)?void 0:"important";i.style.setProperty(tt,Z,St),(g===s.matchingBracket||g===s.activeIndicator)&&i.style.setProperty("box-shadow","unset","important")}g===s.emphasisElement&&(o?.subtleEmphasis??!0?i.style.setProperty("color","inherit","important"):i.style.removeProperty("color"))}}}const At="#3c3836",Ut="#504945",Kt="#665c54",zt="#7c6f64",Ft="#928374",Jt="#fbf1c7",Qt="#ebdbb2",Xt="#bdae93",Yt="#9d0006",Zt="#79740e",to="#b57614",oo="#076678",eo="#8f3f71",ao="#427b58",ro="#af3a03",pt=Jt,K=Qt,p=Xt,et=Ft,h=At,co=Ut,no=Kt,so=zt,w=Yt,x=Zt,y=to,O=oo,B=eo,$=ao,_=ro,at=w,z=K,R=z,lo=pt,j=K,io=z,rt=_,go=A.EditorView.theme({"&":{color:h,backgroundColor:lo},".cm-content":{caretColor:rt},".cm-cursor, .cm-dropCursor":{borderLeftColor:rt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:io},".cm-panels":{backgroundColor:z,color:h},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:pt,color:y,outline:`1px solid ${p}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:p},".cm-activeLine":{backgroundColor:R},".cm-selectionMatch":{backgroundColor:p},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${p}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:p},".cm-gutters":{backgroundColor:K,color:no,border:"none"},".cm-activeLineGutter":{backgroundColor:R},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:j},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:j,borderBottomColor:j},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:R,color:co}}},{dark:!1}),mo=b.HighlightStyle.define([{tag:t.tags.keyword,color:w},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:$},{tag:[t.tags.variableName],color:O},{tag:[t.tags.function(t.tags.variableName)],color:x,fontStyle:"bold"},{tag:[t.tags.labelName],color:h},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:B},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:h},{tag:[t.tags.brace],color:h},{tag:[t.tags.annotation],color:at},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:B},{tag:[t.tags.typeName,t.tags.className],color:y},{tag:[t.tags.operator,t.tags.operatorKeyword],color:w},{tag:[t.tags.tagName],color:$,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:_},{tag:[t.tags.angleBracket],color:O},{tag:[t.tags.attributeName],color:$},{tag:[t.tags.regexp],color:$},{tag:[t.tags.quote],color:et},{tag:[t.tags.string],color:h},{tag:t.tags.link,color:so,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:B},{tag:[t.tags.meta],color:y},{tag:[t.tags.comment],color:et,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:_},{tag:t.tags.emphasis,fontStyle:"italic",color:x},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:x},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:x},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:y},{tag:[t.tags.heading5,t.tags.heading6],color:y},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:B},{tag:[t.tags.processingInstruction,t.tags.inserted],color:O},{tag:[t.tags.contentSeparator],color:w},{tag:t.tags.invalid,color:_,borderBottom:`1px dotted ${at}`}]),uo=[go,b.syntaxHighlighting(mo)],ho="#282828",fo="#3c3836",bo="#665c54",po="#928374",ko="#ebdbb2",yo="#d5c4a1",Co="#bdae93",vo="#a89984",xo="#fb4934",Bo="#b8bb26",$o="#fabd2f",kt="#83a598",To="#d3869b",So="#8ec07c",Mo="#fe8019",yt=ho,F=fo,k=bo,ct=po,f=ko,No=yo,wo=Co,_o=vo,q=xo,T=Bo,C=$o,nt=kt,S=To,M=So,L=Mo,st=q,J=F,I=J,qo=yt,V=F,Lo=J,lt=L,Po=A.EditorView.theme({"&":{color:f,backgroundColor:qo},".cm-content":{caretColor:lt},".cm-cursor, .cm-dropCursor":{borderLeftColor:lt},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Lo},".cm-panels":{backgroundColor:J,color:f},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:yt,color:C,outline:`1px solid ${k}`},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:k},".cm-activeLine":{backgroundColor:I},".cm-selectionMatch":{backgroundColor:k},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{outline:`1px solid ${k}`,fontStyle:"bold"},"&.cm-focused .cm-matchingBracket":{backgroundColor:k},".cm-gutters":{backgroundColor:F,color:wo,border:"none"},".cm-activeLineGutter":{backgroundColor:I},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:V},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:V,borderBottomColor:V},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:I,color:No}}},{dark:!0}),Eo=b.HighlightStyle.define([{tag:t.tags.keyword,color:q},{tag:[t.tags.name,t.tags.deleted,t.tags.character,t.tags.propertyName,t.tags.macroName],color:M},{tag:[t.tags.variableName],color:nt},{tag:[t.tags.function(t.tags.variableName)],color:T,fontStyle:"bold"},{tag:[t.tags.labelName],color:f},{tag:[t.tags.color,t.tags.constant(t.tags.name),t.tags.standard(t.tags.name)],color:S},{tag:[t.tags.definition(t.tags.name),t.tags.separator],color:f},{tag:[t.tags.brace],color:f},{tag:[t.tags.annotation],color:st},{tag:[t.tags.number,t.tags.changed,t.tags.annotation,t.tags.modifier,t.tags.self,t.tags.namespace],color:S},{tag:[t.tags.typeName,t.tags.className],color:C},{tag:[t.tags.operator,t.tags.operatorKeyword],color:q},{tag:[t.tags.tagName],color:M,fontStyle:"bold"},{tag:[t.tags.squareBracket],color:L},{tag:[t.tags.angleBracket],color:nt},{tag:[t.tags.attributeName],color:M},{tag:[t.tags.regexp],color:M},{tag:[t.tags.quote],color:ct},{tag:[t.tags.string],color:f},{tag:t.tags.link,color:_o,textDecoration:"underline",textUnderlinePosition:"under"},{tag:[t.tags.url,t.tags.escape,t.tags.special(t.tags.string)],color:S},{tag:[t.tags.meta],color:C},{tag:[t.tags.comment],color:ct,fontStyle:"italic"},{tag:t.tags.strong,fontWeight:"bold",color:L},{tag:t.tags.emphasis,fontStyle:"italic",color:T},{tag:t.tags.strikethrough,textDecoration:"line-through"},{tag:t.tags.heading,fontWeight:"bold",color:T},{tag:[t.tags.heading1,t.tags.heading2],fontWeight:"bold",color:T},{tag:[t.tags.heading3,t.tags.heading4],fontWeight:"bold",color:C},{tag:[t.tags.heading5,t.tags.heading6],color:C},{tag:[t.tags.atom,t.tags.bool,t.tags.special(t.tags.variableName)],color:S},{tag:[t.tags.processingInstruction,t.tags.inserted],color:kt},{tag:[t.tags.contentSeparator],color:q},{tag:t.tags.invalid,color:L,borderBottom:`1px dotted ${st}`}]),Go=[Po,b.syntaxHighlighting(Eo)],it=(e,c={})=>e??c,Ho=it(it(m.MarkEdit.userSettings)["extension.markeditThemeGruvbox"]),gt=Ho.enabledMode??"both",Oo={extension:uo},Ro={extension:Go};Vt({light:["both","light"].includes(gt)?Oo:void 0,dark:["both","dark"].includes(gt)?Ro:void 0});
